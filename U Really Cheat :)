-- Load Rayfield UI Library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
if not Rayfield then
    warn("Rayfield gagal dimuat!")
    return
end

local Window = Rayfield:CreateWindow({Name = "My Script"})
if not Window then
    warn("Window gagal dibuat!")
    return
end

-- Tab Utama
local TabMain = Window:CreateTab("Main")

-- **Memuat konfigurasi UI sebelumnya**
Rayfield:LoadConfiguration()

-- ESP System
local ESP_Toggle = false
local function ESP(player)
    if not player.Character or not player.Character:FindFirstChild("Head") then return end
    
    local Billboard = Instance.new("BillboardGui")
    Billboard.Adornee = player.Character.Head
    Billboard.Size = UDim2.new(4, 0, 1, 0)
    Billboard.StudsOffset = Vector3.new(0, 2, 0)
    Billboard.AlwaysOnTop = true

    local TextLabel = Instance.new("TextLabel")
    TextLabel.Parent = Billboard
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.BackgroundTransparency = 1
    TextLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
    TextLabel.TextScaled = true
    TextLabel.Text = player.Name

    Billboard.Parent = game.CoreGui
end

local function EnableESP()
    for _, player in pairs(game:GetService("Players"):GetPlayers()) do
        if player ~= game.Players.LocalPlayer then
            ESP(player)
        end
    end
end

TabMain:CreateToggle({
    Name = "ESP Players",
    Callback = function(Value)
        ESP_Toggle = Value
        if ESP_Toggle then
            EnableESP()
        else
            for _, v in pairs(game.CoreGui:GetChildren()) do
                if v:IsA("BillboardGui") then
                    v:Destroy()
                end
            end
        end
    end
})

-- WalkSpeed Hack
TabMain:CreateToggle({
    Name = "WalkSpeed (50)",
    Flag = "WalkSpeedToggle", -- **Menyimpan status toggle**
    Callback = function(Value)
        local char = game.Players.LocalPlayer.Character
        if char and char:FindFirstChild("Humanoid") then
            char.Humanoid.WalkSpeed = Value and 50 or 16
        end
    end
})

-- JumpPower Hack
TabMain:CreateToggle({
    Name = "JumpPower (100)",
    Flag = "JumpPowerToggle", -- **Menyimpan status toggle**
    Callback = function(Value)
        local char = game.Players.LocalPlayer.Character
        if char and char:FindFirstChild("Humanoid") then
            char.Humanoid.JumpPower = Value and 100 or 50
        end
    end
})

-- Fly System
local Fly_Toggle = false
local BodyVelocity

local function EnableFly()
    local player = game.Players.LocalPlayer
    local char = player.Character
    local humanoidRootPart = char and char:FindFirstChild("HumanoidRootPart")

    if humanoidRootPart then
        if not BodyVelocity then
            BodyVelocity = Instance.new("BodyVelocity")
            BodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
            BodyVelocity.Velocity = Vector3.new(0, 50, 0)
            BodyVelocity.Parent = humanoidRootPart
        end
    end
end

TabMain:CreateToggle({
    Name = "Fly",
    Flag = "FlyToggle", -- **Menyimpan status toggle**
    Callback = function(Value)
        Fly_Toggle = Value
        if Fly_Toggle then
            EnableFly()
        else
            if BodyVelocity then
                BodyVelocity:Destroy()
                BodyVelocity = nil
            end
        end
    end
})

-- Anti Teleport Kembali
local function AntiTPKembali()
    local player = game.Players.LocalPlayer
    if not player.Character then return end

    local HumanoidRootPart = player.Character:FindFirstChild("HumanoidRootPart")
    if HumanoidRootPart then
        HumanoidRootPart:GetPropertyChangedSignal("Position"):Connect(function()
            if not Fly_Toggle then
                HumanoidRootPart.Position = HumanoidRootPart.Position + Vector3.new(math.random(-5, 5), 0, math.random(-5, 5))
            end
        end)
    end
end

AntiTPKembali()

Rayfield:Notify({
    Title = "Script Loaded",
    Content = "All Features Activated!",
    Duration = 5
})
